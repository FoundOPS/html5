<div id="routeDestinationDetails" data-role="view" data-show="routeDestinationDetails.show" data-title="Destination Info">

    <div id="locationInfo" data-bind="source: this" data-template="locationTemplate" style="margin-bottom:10px"></div>

    <div>
    <p style="top:10px; margin-bottom: -5px;">Contacts</p>
    <hr style="width:90%;"/>
    </div>
    <ul id="contacts-listview" data-bind="source:contacts, click: contactClick" data-role="listview" data-style="inset" data-template="contactsTemplate"></ul>

    <p style="top:10px; margin-bottom: -5px;">Tasks</p>
    <hr style="width:90%;"/>
    <ul id="routeTasksListView" data-bind="source: dataSource, click: select"
        data-role="listview" data-style="inset" data-template="routeTasksTemplate">
    </ul>
    <footer></footer>
</div>
<script type="text/x-kendo-template" id="locationTemplate">
    <h1>${selectedEntity.Client.Name}</h1>
    <hr style="width:95%; margin: 10px 0px 20px 0px"/>
    # if (selectedEntity.Location) { #
    <p>${selectedEntity.Location.AddressLineOne}</p>
    <p>${selectedEntity.Location.AddressLineTwo}</p>
    <p>${selectedEntity.Location.City}, ${selectedEntity.Location.State}<br/>
        ${selectedEntity.Location.ZipCode}</p>
    # } else { #
    <p style="color:red"> No<br/>Location<br/>Information<br/>Available</p>
    <label id="directionsWarning">Direction information may not be 100% accurate.</label>
    # } #
    <span class="km-text"><a id="directionsButton" data-bind="click: getDirections">Directions</a></span>

</script>
<script type="text/x-kendo-template" id="contactsTemplate">
    # if (Type === "Phone Number") { #
        <a>Call ${Label}<p class="contactData">${Data}</p></a>
    # } else if (Type === "Email Address") { #
        <a>E-mail ${Label}<p class="contactData">${Data}</p></a>
    # } else if (Type === "Website") { #
        <a>Visit Website<p class="contactData">${Data}</p></a>
    # } else { #
        <a>${Label} - ${Data}</a>
    # } #
</script>
    <script type="text/x-kendo-template" id="routeTasksTemplate">
    <a>${Name}</a>
</script>
<script>
    //Wait until directionsButton is loaded
    setTimeout( function () {
        if (kendo.support.detectOS(navigator.userAgent).device) {
            console.log(kendo.support.detectOS(navigator.userAgent).device);
            document.getElementById("directionsButton").addEventListener('touchstart', function (e) {
                $("#directionsButton").toggleClass("buttonClicked");
            });
            document.getElementById("directionsButton").addEventListener('touchend', function (e) {
                $("#directionsButton").toggleClass("buttonClicked");
            });
        } else {
            $("#directionsButton").mousedown(function (e) {
                $("#directionsButton").toggleClass("buttonClicked");
            });
            $("#directionsButton").mouseup(function (e) {
                $("#directionsButton").toggleClass("buttonClicked");
            });
        }
    }, 0);
</script>
