// Copyright 2012 FoundOPS LLC. All Rights Reserved.

define(["db/services","tools","db/saveHistory","widgets/settingsMenu"],function(services,tools,saveHistory){var changePassword={};return changePassword.save=function(){var oldPass=$("#old")[0].value,newPass=$("#new")[0].value,confirmPass=$("#confirm")[0].value;changePassword.validator.validate&&(services.updatePassword(oldPass,newPass,confirmPass),$("#old")[0].value="",$("#new")[0].value="",$("#confirm")[0].value="",tools.disableButtons("#changePassword"),application.navigate("view/personalSettings.html"))},changePassword.cancel=function(){$("#old")[0].value="",$("#new")[0].value="",$("#confirm")[0].value="",tools.disableButtons("#changePassword"),application.navigate("view/personalSettings.html")},changePassword.initialize=function(){var menu=$("#changePassword .settingsMenu");kendo.bind(menu),menu.kendoSettingsMenu(),tools.observeInput("#changePassword"),changePassword.validator=$("#changePasswordForm").kendoValidator({rules:{custom:function(input){return input.is("[name=confirm]")&&input.val()===$("#new")[0].value||!input.is("[name=confirm]")}},messages:{custom:"The passwords do not match."}}).data("kendoValidator")},window.changePassword=changePassword,changePassword})